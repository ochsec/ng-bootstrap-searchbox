{"version":3,"file":"searchbox.component.js","sourceRoot":"","sources":["../src/searchbox.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, OnDestroy, Input, Output, EventEmitter } from '@angular/core';\r\nimport { FormBuilder, FormGroup, AbstractControl } from '@angular/forms';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { Subject } from 'rxjs/Subject';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport 'rxjs/add/operator/map';\r\nimport 'rxjs/add/operator/switchMap';\r\nimport 'rxjs/add/operator/debounceTime';\r\nimport 'rxjs/add/operator/distinctUntilChanged';\r\nimport 'rxjs/add/operator/takeUntil';\r\n\r\n\r\nexport class SearchboxComponent implements OnInit, OnDestroy {\r\n     public model: any;\r\n     public records: Array<any>;\r\n     update = new EventEmitter<Array<any>>();\r\n    private ngUnsubscribe: Subject<void> = new Subject<void>();\r\n    visible = false;\r\n    searchControl: AbstractControl;\r\n    entities: Array<any>;\r\n    form: FormGroup;\r\n\r\n    constructor(private _fb: FormBuilder) { }\r\n\r\n    ngOnInit() {\r\n        this.form = this._fb.group({\r\n            SearchBox: ['']\r\n        });\r\n\r\n        this.searchControl = this.form.controls['SearchBox'];\r\n\r\n        this.searchControl.valueChanges\r\n            .distinctUntilChanged()\r\n            .debounceTime(500)\r\n            .map((term: string) => term != null ? term.toString().trim() : null)\r\n            .switchMap((term: string) => this.searchEntities(term))\r\n            .takeUntil(this.ngUnsubscribe)\r\n            .subscribe(data => {\r\n                this.update.emit(data);\r\n            });\r\n\r\n        this.entities = this.records;\r\n    }\r\n\r\n    searchEntities(query: string): Observable<Array<any>> {\r\n        const term = query === null ? '' : query.trim().toLowerCase();\r\n        const tempList = new Array<any>();\r\n        const result = new Observable<Array<any>>(observer => {\r\n            if (term === '') {\r\n                observer.next(this.entities);\r\n            } else {\r\n                const keys = Object.keys(this.entities[0]);\r\n                this.entities.forEach(e => {\r\n                    let match = false;\r\n                    for (const key of keys) {\r\n                        if (e[key] && e[key].toString().toLowerCase().indexOf(term) > -1) {\r\n                            match = true;\r\n                        }\r\n                    }\r\n                    if (match) {\r\n                        tempList.push(e);\r\n                    }\r\n                });\r\n                observer.next(tempList);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.ngUnsubscribe.next();\r\n        this.ngUnsubscribe.complete();\r\n    }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\r\n    selector: 'searchbox',\r\n    templateUrl: 'searchbox.component.html'\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: FormBuilder, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'model': [{ type: Input, args: ['model', ] },],\n'records': [{ type: Input, args: ['records', ] },],\n'update': [{ type: Output },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}