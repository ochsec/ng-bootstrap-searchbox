{"version":3,"file":"searchbox.component.js","sourceRoot":"","sources":["../src/searchbox.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, OnDestroy, Input, Output, EventEmitter } from '@angular/core';\nimport { FormBuilder, FormGroup, AbstractControl } from '@angular/forms';\nimport { Observable } from 'rxjs/Observable';\nimport { Subject } from 'rxjs/Subject';\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\nimport { Subscription } from 'rxjs/Subscription';\nimport 'rxjs/add/operator/map';\nimport 'rxjs/add/operator/switchMap';\nimport 'rxjs/add/operator/debounceTime';\nimport 'rxjs/add/operator/distinctUntilChanged';\nimport 'rxjs/add/operator/takeUntil';\n\n\nexport class SearchboxComponent implements OnInit, OnDestroy {\n    private _records = new BehaviorSubject<Array<any>>([]);\n     \n      set records(value) { this._records.next(value); }\n      get records() { return this._records.getValue(); }\n     update = new EventEmitter<Array<any>>();\n    private ngUnsubscribe: Subject<void> = new Subject<void>();\n    visible = false;\n    searchControl: AbstractControl;\n    entities: Array<any>;\n    form: FormGroup;\n\n    constructor(private _fb: FormBuilder) { }\n\n    ngOnInit() {\n        this.form = this._fb.group({\n            SearchBox: ['']\n        });\n\n        this.searchControl = this.form.controls['SearchBox'];\n\n        this.searchControl.valueChanges\n            .distinctUntilChanged()\n            .debounceTime(500)\n            .map((term: string) => term != null ? term.toString().trim() : null)\n            .switchMap((term: string) => this.searchEntities(term))\n            .takeUntil(this.ngUnsubscribe)\n            .subscribe(data => {\n                this.update.emit(data);\n                console.log(data);\n            });\n    }\n\n    searchEntities(query: string): Observable<Array<any>> {\n        const term = query === null ? '' : query.trim().toLowerCase();\n        const tempList = new Array<any>();\n        if (!this.entities) {\n          this.entities = this.records;\n        }\n        const result = new Observable<Array<any>>(observer => {\n            if (term === '') {\n                observer.next(this.entities);\n            } else {\n                const keys = Object.keys(this.entities[0]);\n                this.entities.forEach(e => {\n                    let match = false;\n                    for (const key of keys) {\n                        if (e[key] && e[key].toString().toLowerCase().indexOf(term) > -1) {\n                            match = true;\n                        }\n                    }\n                    if (match) {\n                        tempList.push(e);\n                    }\n                });\n                observer.next(tempList);\n            }\n        });\n\n        return result;\n    }\n\n    ngOnDestroy() {\n        this.ngUnsubscribe.next();\n        this.ngUnsubscribe.complete();\n    }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n    selector: 'searchbox',\n    templateUrl: './searchbox.component.html'\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: FormBuilder, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'records': [{ type: Input, args: ['records', ] },],\n'update': [{ type: Output },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}